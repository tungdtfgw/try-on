# US-03: Quản lý danh mục sản phẩm

## Bối cảnh
- Epic: Quản lý kho hàng.
- Vai trò: Admin.
- Mục tiêu: Có hệ thống phân loại sản phẩm bằng danh mục để dễ dàng tổ chức và tìm kiếm.

## Phạm vi
- Admin có thể xem danh sách tất cả các danh mục (categories).
- Admin có thể tạo danh mục mới với tên và mô tả.
- Admin có thể sửa thông tin danh mục đã có.
- Admin có thể xóa danh mục (nếu không còn sản phẩm nào thuộc danh mục đó).
- Người dùng thông thường (non-admin) có thể xem danh sách danh mục nhưng không được phép tạo/sửa/xóa.
- Hệ thống tự động tạo slug từ tên danh mục để dùng cho URL thân thiện.

## Luồng chính (happy path)
- **Xem danh sách:** Admin truy cập trang quản lý danh mục → hệ thống hiển thị danh sách tất cả categories dạng table/card với tên, slug, số lượng sản phẩm, ngày tạo.
- **Tạo mới:** Admin bấm "Thêm danh mục" → nhập tên và mô tả → submit → server validate → tự động tạo slug → lưu vào database → thông báo thành công → danh sách được refresh.
- **Sửa:** Admin bấm "Sửa" trên 1 danh mục → form hiển thị thông tin hiện tại → Admin chỉnh sửa → submit → server validate → cập nhật database → thông báo thành công → danh sách được refresh.
- **Xóa:** Admin bấm "Xóa" trên 1 danh mục → hiển thị confirmation dialog → Admin xác nhận → server kiểm tra không còn sản phẩm nào → xóa khỏi database → thông báo thành công → danh sách được refresh.

## Luồng lỗi cần xử lý
- Tên danh mục trống hoặc quá dài (>100 ký tự).
- Slug bị trùng (tên danh mục giống nhau) → thêm số vào cuối slug.
- Xóa danh mục còn sản phẩm → chặn và thông báo "Không thể xóa danh mục đang có sản phẩm".
- Non-admin cố gắng truy cập endpoint tạo/sửa/xóa → trả về 403 Forbidden.
- Lỗi mạng/server → thông báo thân thiện, không lộ chi tiết.
- Category không tồn tại khi sửa/xóa → trả về 404 Not Found.

## Dữ liệu & validate gợi ý
- **name:** bắt buộc, string, 1-100 ký tự, trim whitespace.
- **slug:** tự động generate từ name (lowercase, replace spaces với dashes, remove special chars), unique.
- **description:** optional, string, max 500 ký tự.
- **created_at, updated_at:** timestamp, tự động.

## Acceptance Criteria (kết hợp sprint backlog)
- Admin có thể xem danh sách tất cả categories.
- Admin có thể tạo category mới với validation đầy đủ.
- Slug được tự động tạo từ tên và đảm bảo unique.
- Admin có thể sửa thông tin category.
- Admin có thể xóa category (chỉ khi không có products).
- Non-admin không thể tạo/sửa/xóa categories (trả về 403).
- Validation và thông báo lỗi rõ ràng cho từng trường hợp.
- UI/UX thân thiện, responsive trên mobile và desktop.

## Phi chức năng
- Endpoint public (GET /api/categories) không yêu cầu authentication.
- Endpoint admin (POST, PUT, DELETE) yêu cầu JWT và role=admin.
- Database indexes trên slug để tối ưu query.
- Thông báo lỗi/success nhất quán với phần còn lại của hệ thống.
- UI hoạt động tốt trên desktop và mobile cơ bản.
- API response time < 500ms cho operations thông thường.
